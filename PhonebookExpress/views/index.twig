{% extends 'layout.twig' %}

{% block body %}
    {% verbatim %}
<nav class="navbar navbar-light bg-light">
    <div class="container">
        <a class="navbar-brand" href="#phonebook">
            <img src="images/phone-book-contacts.svg" alt="" width="30" height="24"
                 class="d-inline-block align-text-top">
            Phonebook v2.0
        </a>
    </div>
</nav>
<div class="container" id="app">
    <form @submit.prevent="addContact" class="row g-3 border needs-validation mt-3 py-2" novalidate>
        <div class="col-md-4 mt-0">
            <label for="first_name" class="form-label">First name</label>
            <input type="text" id="first_name" class="form-control" v-model.trim="firstName" :class="{'is-invalid': isFirstNameInvalid}" required>
            <div class="invalid-feedback">
                Please provide your name
            </div>
        </div>
        <div class="col-md-4 mt-0">
            <label for="last_name" class="form-label">Last name</label>
            <input type="text" id="last_name" class="form-control" v-model.trim="lastName" :class="{'is-invalid': isLastNameInvalid}" required>
            <div class="invalid-feedback">
                Please provide your last name
            </div>
        </div>
        <div class="col-md-4 mt-0">
            <label for="telephone_number" class="form-label">Telephone</label>
            <input type="tel" id="telephone_number" class="form-control" v-model.trim="telephone" :class="{'is-invalid': isTelephoneInvalid}" required>
            <div class="invalid-feedback">
                You have to enter phone number
            </div>
        </div>
        <div>
            <button class="btn btn-primary my-1" id="add_contact_button">Add contact</button>
            <button class="btn btn-danger my-1" type="button" id="delete_selected_button">Delete selected</button>
            <button @click.prevent="clearForm" class="btn btn-secondary my-1" type="button" id="clear_form_button">Clear form</button>
        </div>
    </form>

    <div class="row justify-content-center">
        <form class="g-3 col-md-6 col-12 border mt-3 py-3" novalidate id="search_form">
            <div class="input-group">
                <button class="btn btn-outline-secondary" type="button" id="reset_filter_button">Reset</button>
                <input type="text" class="form-control" placeholder="Type to search" aria-label="Search panel" id="filter_input">
                <button class="btn btn-primary" type="button" id="enable_filter_button">Filter</button>
            </div>
        </form>
    </div>

    <table v-cloak class="table table-responsive table-hover mt-3">
        <thead class="table-light">
        <tr>
            <th class="align-middle">
                <div class="form-check">
                    <input class="form-check-input"
                           type="checkbox"
                           value=""
                           id="general_checkbox">
                </div>
            </th>
            <th class="align-middle" scope="col">#</th>
            <th class="align-middle" scope="col">First Name</th>
            <th class="align-middle" scope="col">Last Name</th>
            <th class="align-middle" scope="col">Phone number</th>
            <th class="align-middle" scope="col"></th>
        </tr>
        </thead>
        <tbody>
            <tr v-for="(contact, index) in contacts"
                            :key="contact.id"
                            :contact="contact"
                            :index="index">
                <td class="contactSelector">
                <div class="form-check"><input class="form-check-input" type="checkbox" v-model="contact.checked"></div>
                </td>
                <td>{{ index + 1 }}</td>
                <td>{{ contact.firstName }}</td>
                <td>{{ contact.lastName }}</td>
                <td>{{ contact.telephone }}</td>
                <td><button @click="showConfirmDeleteDialog(contact)" type="button" class="btn-close" aria-label="Delete" data-bs-toggle="modal" data-bs-toggle="modal" data-bs-target="#delete_confirmation_modal"></button>
                </td>
            </tr>
        </tbody>
    </table>

    <delete-modal ref="confirmDeleteDialog">
    <template v-if="isContactForDeleteExists" v-slot:contact-name> {{ contactForDelete.firstName }} {{ contactForDelete.lastName }}</template>
    </delete-modal>

    <telephone-exists-modal ref="telephoneExistsDialog">
    </telephone-exists-modal>

    <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
        <div class="col-md-2 align-items-center">
            <span class="text-muted">Â© Maxim Biluta</span>
        </div>
    </footer>
</div>

<!-- Contact exists Modal -->
<script type="text/x-template" id="telephone-exists-modal-template">
<div ref="modalTelephoneExists" class="modal fade" tabindex="-1" aria-labelledby="modalTelephoneExistsLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalTelephoneExistsLabel">Cannot add the contact</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            Telephone exists.
            </div>
            <div class="modal-footer">
                <button type="button"
                        class="btn btn-warning"
                        data-bs-dismiss="modal"
                        id="modal-dismiss">Dismiss
                </button>
            </div>
        </div>
    </div>
</div>
</script>

<!-- Confirm delete Modal -->
<script type="text/x-template" id="delete-modal-template">
<div ref="modalConfirmDelete" class="modal fade" id="delete_confirmation_modal" tabindex="-1" aria-labelledby="modalConfirmDeleteLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalConfirmDeleteLabel">Delete confirmation</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            Delete contact<slot name="contact-name"></slot>?
            </div>
            <div class="modal-footer">
                <button type="button"
                        class="btn btn-secondary"
                        data-bs-dismiss="modal"
                        id="modal-cancel">Cancel
                </button>
                <button type="button"
                        @click="confirmDelete"
                        class="btn btn-danger"
                        data-bs-dismiss="modal"
                        id="modal-delete">Delete
                </button>
            </div>
        </div>
    </div>
</div>
</script>
{% endverbatim %}
{% endblock %}
